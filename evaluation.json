{
  "system": {
    "role": "system",
    "content": "You are an automated code evaluation assistant. Your task is to evaluate whether a proposed code change satisfies the stated invariants and intent within the given structural context. You must not speculate about tests or runtime behavior beyond what is implied by the invariants. You must not infer requirements beyond what is explicitly stated. Respond ONLY with valid JSON matching the requested schema."
  },
  "user": {
    "role": "user",
    "content": "PROBLEM CONTEXT:\nYou are evaluating a debugging task involving a simple in-memory rate limiter implemented in Python.\n\nSTRUCTURAL CONTEXT:\n- The file defines a class named `RateLimiter`.\n- The primary method under evaluation is `allow_request(self, user_id: str) -> bool`.\n- This method is responsible for deciding whether a request should be allowed and for updating internal state accordingly.\n- The class maintains state across calls using an in-memory mapping from `user_id` to a collection of request timestamps.\n- Mutations to this state directly affect future request eligibility.\n\nNON-NEGOTIABLE INVARIANTS (must hold for any correct solution):\n1. A user may make at most `limit` requests within any rolling window of `window_seconds`.\n2. Requests older than the time window must not count toward the limit.\n3. A rejected request must not affect future request eligibility.\n4. State updates must remain consistent under rapid successive requests and large time gaps.\n\nINTENT (non-binding, for scope only):\nThe incorrect behavior arises from how request timestamps are stored, cleaned up, and evaluated over time within the `allow_request` method.\n\nSUBMISSION DIFF (unified diff):\n{{GIT_DIFF_HERE}}\n\nEVALUATION TASKS:\n1. Determine whether the submitted change satisfies all non-negotiable invariants in the context of the class and its stateful behavior.\n2. Determine whether the change meaningfully addresses the intended area of concern.\n3. Evaluate whether any additional changes beyond what is necessary are:\n   a) unnecessary noise, or\n   b) a valid alternative or structural improvement that still respects the invariants.\n\nIMPORTANT GUIDELINES:\n- Do NOT require the solution to match any specific implementation strategy.\n- Do NOT penalize refactors or alternative data structures if invariants are preserved.\n- Do NOT judge stylistic choices unless they directly affect correctness or state consistency.\n- Multiple solution approaches may be valid.\n\nRespond ONLY with valid JSON using the following schema:\n{\n  \"satisfies_invariants\": boolean,\n  \"addresses_intent\": boolean,\n  \"additional_changes\": \"none\" | \"unnecessary\" | \"valid_alternative\",\n  \"change_scope\": \"minimal\" | \"moderate\" | \"excessive\"\n}"
  }
}
